{
   "dashboard":{
      "data":{
         "charts":[
            {
               "chart_title":"OCI WAF Records",
               "chart_type":"line",
               "col_end":30,
               "col_start":2,
               "row_end":17,
               "row_start":2,
               "templateID":0,
               "type":"custom"
            },
            {
               "chart_title":"WAF Syslog Records",
               "chart_type":"table",
               "col_end":89,
               "col_start":2,
               "row_end":114,
               "row_start":50,
               "templateID":1,
               "type":"custom"
            },
            {
               "chart_title":"Source IP",
               "chart_type":"donut",
               "col_end":30,
               "col_start":2,
               "row_end":33,
               "row_start":18,
               "templateID":2,
               "type":"custom"
            },
            {
               "chart_title":"Action",
               "chart_type":"donut",
               "col_end":60,
               "col_start":31,
               "row_end":17,
               "row_start":2,
               "templateID":3,
               "type":"custom"
            },
            {
               "chart_title":"Destination Hosts",
               "chart_type":"donut",
               "col_end":60,
               "col_start":31,
               "row_end":33,
               "row_start":18,
               "templateID":4,
               "type":"custom"
            },
            {
               "chart_title":"Response Codes",
               "chart_type":"donut",
               "col_end":89,
               "col_start":61,
               "row_end":17,
               "row_start":2,
               "templateID":5,
               "type":"custom"
            },
            {
               "chart_title":"By country",
               "chart_type":"donut",
               "col_end":30,
               "col_start":2,
               "row_end":49,
               "row_start":34,
               "templateID":6,
               "type":"custom"
            },
            {
               "chart_title":"Bad URL",
               "chart_type":"donut",
               "col_end":60,
               "col_start":31,
               "row_end":49,
               "row_start":34,
               "templateID":7,
               "type":"custom"
            },
            {
               "chart_title":"URL",
               "chart_type":"donut",
               "col_end":89,
               "col_start":61,
               "row_end":33,
               "row_start":18,
               "templateID":8,
               "type":"custom"
            },
            {
               "chart_title":"Rules",
               "chart_type":"donut",
               "col_end":89,
               "col_start":61,
               "row_end":49,
               "row_start":34,
               "templateID":9,
               "type":"custom"
            }
         ],
         "cust_id":0,
         "custom":false,
         "description":"WAF processing statistics",
         "height":2400,
         "id":"42OkhEULli8ctH22RwK00a4dc",
         "new":false,
         "padding":0,
         "title":"WAF Events - blocked",
         "width":1807
      },
      "name":"WAF Events - blocked",
      "object_type":"dashboard",
      "template":"custom"
   },
   "charts":[
      {
         "name":"OCI WAF Records",
         "object_type":"chart",
         "data":{
            "aggs":[
               {
                  "field":"timestamp",
                  "info":[
                     "timestamp"
                  ],
                  "interval":"5m",
                  "metric":"doc_count",
                  "metric_field":"",
                  "name":"time",
                  "type":"time"
               }
            ],
            "chart_type":"line",
            "config":{
               "filter_type":"",
               "index":"aella-syslog-*",
               "label_x":"",
               "label_y":"",
               "query_type":{
                  "cats":[
                     0
                  ],
                  "type":"custom"
               },
               "stack":false,
               "title":"OCI WAF Records",
               "title_color":"#FAFAFA"
            }
         },
         "id":0
      },
      {
         "name":"WAF Syslog Records",
         "object_type":"chart",
         "data":{
            "aggs":[
               
            ],
            "chart_type":"table",
            "config":{
               "cols":[
                  {
                     "id":"timestamp",
                     "name":"Time"
                  },
                  {
                     "id":"oracle.data.clientAddr",
                     "name":"Source IP"
                  },
                  {
                     "id":"oracle.data.host",
                     "name":"Destination Host"
                  },
                  {
                     "id":"oracle.data.action",
                     "name":"Action"
                  },
                  {
                     "id":"oracle.data.response.code",
                     "name":"Response Code"
                  },
                  {
                     "id":"oracle.data.request.path",
                     "name":"Path"
                  }
               ],
               "filterable":true,
               "index":"aella-syslog-*",
               "query_type":{
                  "cats":[
                     0
                  ],
                  "type":"custom"
               },
               "rowsPerPage":30,
               "table_type":"per_record",
               "title":"WAF Syslog Records"
            }
         },
         "id":1
      },
      {
         "name":"Source IP",
         "object_type":"chart",
         "data":{
            "aggs":[
               {
                  "direction":"desc",
                  "field":"oracle.data.clientAddr.keyword",
                  "info":[
                     "oracle.data.clientAddr"
                  ],
                  "metric":"doc_count",
                  "metric_field":"",
                  "name":"Column 1",
                  "size":25,
                  "type":"bucket"
               }
            ],
            "chart_type":"donut",
            "config":{
               "filter_type":"oracle.data.clientAddr.keyword",
               "index":"aella-syslog-*",
               "label_field":"oracle.data.clientAddr",
               "query_type":{
                  "cats":[
                     0
                  ],
                  "type":"custom"
               },
               "title":"Source IP",
               "value_field":"doc_count"
            }
         },
         "id":2
      },
      {
         "name":"Action",
         "object_type":"chart",
         "data":{
            "aggs":[
               {
                  "direction":"desc",
                  "field":"oracle.data.action.keyword",
                  "info":[
                     "oracle.data.action"
                  ],
                  "metric":"doc_count",
                  "metric_field":"",
                  "name":"Column 1",
                  "size":10,
                  "type":"bucket"
               }
            ],
            "chart_type":"donut",
            "config":{
               "filter_type":"oracle.data.action.keyword",
               "index":"aella-syslog-*",
               "label_field":"oracle.data.action",
               "query_type":{
                  "cats":[
                     0
                  ],
                  "type":"custom"
               },
               "title":"Action",
               "value_field":"doc_count"
            }
         },
         "id":3
      },
      {
         "name":"Destination Hosts",
         "object_type":"chart",
         "data":{
            "aggs":[
               {
                  "direction":"desc",
                  "field":"oracle.data.host.keyword",
                  "info":[
                     "oracle.data.host"
                  ],
                  "metric":"doc_count",
                  "metric_field":"",
                  "name":"Column 1",
                  "size":25,
                  "type":"bucket"
               }
            ],
            "chart_type":"donut",
            "config":{
               "filter_type":"oracle.data.host.keyword",
               "index":"aella-syslog-*",
               "label_field":"oracle.data.host",
               "query_type":{
                  "cats":[
                     0
                  ],
                  "type":"custom"
               },
               "title":"Destination Hosts",
               "value_field":"doc_count"
            }
         },
         "id":4
      },
      {
         "name":"Response Codes",
         "object_type":"chart",
         "data":{
            "aggs":[
               {
                  "direction":"desc",
                  "field":"oracle.data.response.code",
                  "info":[
                     "oracle.data.response.code"
                  ],
                  "metric":"doc_count",
                  "metric_field":"",
                  "name":"Column 1",
                  "size":25,
                  "type":"bucket"
               }
            ],
            "chart_type":"donut",
            "config":{
               "filter_type":"oracle.data.response.code",
               "index":"aella-syslog-*",
               "label_field":"oracle.data.response.code",
               "query_type":{
                  "cats":[
                     0
                  ],
                  "type":"custom"
               },
               "title":"Response Codes",
               "value_field":"doc_count"
            }
         },
         "id":5
      },
      {
         "name":"By country",
         "object_type":"chart",
         "data":{
            "aggs":[
               {
                  "direction":"desc",
                  "field":"oracle.data.countryCode.keyword",
                  "info":[
                     "oracle.data.countryCode"
                  ],
                  "metric":"doc_count",
                  "metric_field":"",
                  "name":"Column 1",
                  "size":10,
                  "type":"bucket"
               }
            ],
            "chart_type":"donut",
            "config":{
               "filter_type":"oracle.data.countryCode.keyword",
               "index":"aella-syslog-*",
               "label_field":"oracle.data.countryCode",
               "query_type":{
                  "cats":[
                     0
                  ],
                  "type":"custom"
               },
               "title":"By country",
               "value_field":"doc_count"
            }
         },
         "id":6
      },
      {
         "name":"Bad URL",
         "object_type":"chart",
         "data":{
            "aggs":[
               {
                  "direction":"desc",
                  "field":"oracle.data.request.path.keyword",
                  "info":[
                     "oracle.data.request.path"
                  ],
                  "metric":"doc_count",
                  "metric_field":"",
                  "name":"Column 1",
                  "size":25,
                  "type":"bucket"
               }
            ],
            "chart_type":"donut",
            "config":{
               "filter_type":"oracle.data.request.path.keyword",
               "index":"aella-syslog-*",
               "label_field":"oracle.data.request.path",
               "query_type":{
                  "cats":[
                     1
                  ],
                  "type":"custom"
               },
               "title":"Bad URL",
               "value_field":"doc_count"
            }
         },
         "id":7
      },
      {
         "name":"URL",
         "object_type":"chart",
         "data":{
            "aggs":[
               {
                  "direction":"desc",
                  "field":"oracle.data.request.path.keyword",
                  "info":[
                     "oracle.data.request.path"
                  ],
                  "metric":"doc_count",
                  "metric_field":"",
                  "name":"Column 1",
                  "size":10,
                  "type":"bucket"
               }
            ],
            "chart_type":"donut",
            "config":{
               "filter_type":"oracle.data.request.path.keyword",
               "index":"aella-syslog-*",
               "label_field":"oracle.data.request.path",
               "query_type":{
                  "cats":[
                     0
                  ],
                  "type":"custom"
               },
               "title":"URL",
               "value_field":"doc_count"
            }
         },
         "id":8
      },
      {
         "name":"Rules",
         "object_type":"chart",
         "data":{
            "aggs":[
               {
                  "direction":"desc",
                  "field":"oracle.data.requestProtection.matchedIds.keyword",
                  "info":[
                     "oracle.data.requestProtection.matchedIds"
                  ],
                  "metric":"doc_count",
                  "metric_field":"",
                  "name":"Column 1",
                  "size":25,
                  "type":"bucket"
               }
            ],
            "chart_type":"donut",
            "config":{
               "filter_type":"oracle.data.requestProtection.matchedIds.keyword",
               "index":"aella-syslog-*",
               "label_field":"oracle.data.requestProtection.matchedIds",
               "query_type":{
                  "cats":[
                     0
                  ],
                  "type":"custom"
               },
               "title":"Rules",
               "value_field":"doc_count"
            }
         },
         "id":9
      }
   ],
   "queries":[
      {
         "name":"OCI WAF",
         "object_type":"query",
         "conditions":{
            "conditions":[
               {
                  "conditions":[
                     {
                        "field":"oracle.type",
                        "op":"matches",
                        "type":"string",
                        "value":[
                           "com.oraclecloud.loadbalancer.waf"
                        ]
                     }
                  ],
                  "modifier":"and"
               }
            ],
            "modifier":"or"
         },
         "id":0
      },
      {
         "name":"OCI WAF BADURL",
         "object_type":"query",
         "conditions":{
            "conditions":[
               {
                  "conditions":[
                     {
                        "field":"oracle.type",
                        "op":"matches",
                        "type":"string",
                        "value":[
                           "com.oraclecloud.loadbalancer.waf"
                        ]
                     },
                     {
                        "conditions":[
                           {
                              "caseSensitive":true,
                              "field":"oracle.data.request.path",
                              "op":"starts with",
                              "type":"string",
                              "value":[
                                 "/donorportal"
                              ]
                           },
                           {
                              "caseSensitive":true,
                              "field":"oracle.data.request.path",
                              "op":"starts with",
                              "type":"string",
                              "value":[
                                 "/srt"
                              ]
                           },
                           {
                              "caseSensitive":true,
                              "field":"oracle.data.request.path",
                              "op":"starts with",
                              "type":"string",
                              "value":[
                                 "/GenePortal"
                              ]
                           },
                           {
                              "caseSensitive":true,
                              "field":"oracle.data.request.path",
                              "op":"starts with",
                              "type":"string",
                              "value":[
                                 "/swp"
                              ]
                           }
                        ],
                        "modifier":"not"
                     }
                  ],
                  "modifier":"and"
               }
            ],
            "modifier":"or"
         },
         "id":1
      }
   ]
}